<!DOCTYPE html>
<html lang="nl">
<head>
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4062633211824348"
    crossorigin="anonymous"></script>

  <meta charset="UTF-8" />
  <title>Voetbal4All - Sportieve events</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Fonts + CSS -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap">
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Share icons â€“ match live-score banner look */
    .share-live{display:flex;gap:10px;flex-wrap:wrap;align-items:center;min-width:0}
    .share-live .share-a{
      width:36px;height:36px;display:inline-flex;align-items:center;justify-content:center;
      border-radius:999px;
      background:rgba(22,163,74,.92);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:0 10px 26px rgba(0,0,0,.35);
      color:rgba(255,255,255,.95);
      text-decoration:none;cursor:pointer;flex:0 0 auto;
      transition:transform .12s ease,filter .12s ease;
    }
    .share-live .share-a:hover{filter:brightness(1.05);transform:translateY(-1px)}
    .share-live .share-a:active{transform:translateY(0)}
    .share-live .share-a svg{width:18px;height:18px;display:block}
    .share-live .share-a svg path,
    .share-live .share-a svg circle,
    .share-live .share-a svg rect,
    .share-live .share-a svg line,
    .share-live .share-a svg polyline,
    .share-live .share-a svg polygon{stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
    .share-live .share-a svg .fill{fill:currentColor;stroke:none}
    .share-live .share-a.is-small{width:32px;height:32px}
    .share-live .share-a.is-small svg{width:16px;height:16px}

    /* Pagination */
    .events-pagination{display:flex;gap:8px;flex-wrap:wrap;align-items:center;justify-content:center;margin-top:14px}
    .events-pagination .page-btn{
      appearance:none;border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.04);color:rgba(255,255,255,.92);
      border-radius:999px;padding:8px 12px;font-family:inherit;font-weight:600;
      cursor:pointer;transition:transform .12s ease,filter .12s ease,background .12s ease;
    }
    .events-pagination .page-btn:hover{filter:brightness(1.05);transform:translateY(-1px)}
    .events-pagination .page-btn:active{transform:translateY(0)}
    .events-pagination .page-btn.is-active{background:rgba(22,163,74,.22);border-color:rgba(22,163,74,.55)}
    .events-pagination .page-btn:disabled{opacity:.45;cursor:not-allowed;transform:none}

    /* Flyer thumbnail â€“ fixed size, never stretches the card */
    .event-row{display:flex;gap:12px;align-items:flex-start;min-width:0}
    .event-thumbbox{
      width:140px;height:96px;flex:0 0 140px;border-radius:12px;
      border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.04);
      overflow:hidden;position:relative;
    }
    .event-thumbbox::after{content:"Flyer";position:absolute;left:10px;top:8px;font-size:12px;opacity:.55}
    .event-thumbbox.has-img::after{display:none}
    .event-thumbbox .thumbbg{position:absolute;inset:0;background-position:center;background-size:cover;background-repeat:no-repeat;filter:saturate(1.05)}

    .event-main{flex:1 1 auto;min-width:0}
    .event-actions{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

    /* 2-column grids */
    .events-grid-2{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
    @media (max-width: 900px){.events-grid-2{grid-template-columns:1fr}}

    /* Premium blocks */
    .premium-block{margin:12px 0 18px}
    .premium-block .premium-grid{margin-top:10px}

    /* Sidebar premium list (10 cards) */
    .sidebar-premium-stack{display:flex;flex-direction:column;gap:10px}
    .sidebar-premium-card{padding:10px;border-radius:14px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.03)}
    .sidebar-premium-top{display:flex;gap:10px;align-items:flex-start;min-width:0}
    .sidebar-premium-thumbbox{width:64px;height:48px;flex:0 0 64px;border-radius:10px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.04);overflow:hidden;position:relative}
    .sidebar-premium-thumbbox .thumbbg{position:absolute;inset:0;background-position:center;background-size:cover;background-repeat:no-repeat}
    .sidebar-premium-title{font-weight:700;font-size:13px;line-height:1.25}
    .sidebar-premium-meta{font-size:12px;opacity:.8;margin-top:2px}
    .sidebar-premium-actions{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-top:8px}
  </style>
</head>

<!-- Live banner NIET op mobiel voor niet-home paginaâ€™s -->
<body class="v4-hide-live-mobile">
  <div class="page">

    <!-- NAVBAR -->
    <header class="navbar">
      <div class="shell">
        <div class="navbar-inner">

          <a href="index.html" class="brand brand--logo-only">
            <img
              src="assets/img/brand/logo-voetbal4all.svg"
              alt="Voetbal4All"
              class="brand-logo"
              loading="eager"
            />
          </a>

          <nav class="nav-links">
            <a href="index.html" class="nav-link">Home</a>
            <a href="artikels.html" class="nav-link">Artikels</a>

            <!-- SPORTIEVE EVENTS -->
<div class="nav-item nav-item--dropdown">
  <button class="nav-link nav-link--dropdown">
    Sportieve events <span class="nav-link-caret">â–¾</span>
  </button>
  <div class="nav-dropdown">
    <a href="events.html" class="nav-dropdown-link">Alle sportieve events</a>
    <a href="events.html?type=Tornooi" class="nav-dropdown-link">Tornooien</a>
    <a href="events.html?type=Vriendschappelijk" class="nav-dropdown-link">Vriendschappelijke wedstrijden</a>
    <a href="stages.html" class="nav-dropdown-link">Stages</a>
    <a href="events.html?type=Voetbalkamp" class="nav-dropdown-link">Voetbalkampen</a>
  </div>
</div>

            <!-- CLUB & FUN -->
<div class="nav-item nav-item--dropdown">
  <button class="nav-link nav-link--dropdown">
    Club &amp; fun <span class="nav-link-caret">â–¾</span>
  </button>
  <div class="nav-dropdown">
    <a href="algemene-events.html" class="nav-dropdown-link">Alle club &amp; fun events</a>
    <a href="dinners.html" class="nav-dropdown-link">Dinners &amp; eetdagen</a>
    <a href="algemene-events.html?type=Spelavond" class="nav-dropdown-link">Spelavonden &amp; acties</a>
    <a href="algemene-events.html?type=Fuif" class="nav-dropdown-link">Fuif / afterparty</a>
    <a href="algemene-events.html?type=Sponsor" class="nav-dropdown-link">Sponsor &amp; netwerk</a>
  </div>
</div>

            <!-- VACATURES & PROFIELEN -->
            <div class="nav-item nav-item--dropdown">
              <button type="button" class="nav-link nav-link--dropdown">
                Vacatures &amp; profielen <span class="nav-link-caret">â–¾</span>
              </button>
              <div class="nav-dropdown">
                <a href="clubvacatures.html" class="nav-dropdown-link">Clubvacatures</a>
                <a href="trainers.html" class="nav-dropdown-link">Trainers</a>
                <a href="spelers.html" class="nav-dropdown-link">Spelers</a>
              </div>
            </div>

            <!-- SPORTIEF -->
            <div class="nav-item nav-item--dropdown">
              <button type="button" class="nav-link nav-link--dropdown">
                Sportief <span class="nav-link-caret">â–¾</span>
              </button>
              <div class="nav-dropdown">
                <a href="sportief-spelers.html" class="nav-dropdown-link">Spelersstatistieken</a>
                <a href="sportief-teams.html" class="nav-dropdown-link">Teamstatistieken</a>
                <a href="sportief-resultaten.html" class="nav-dropdown-link">Resultaten</a>
                <a href="sportief-rangschikkingen.html" class="nav-dropdown-link">Rangschikkingen</a>
                <a href="sportief-teams-in-de-kijker.html" class="nav-dropdown-link">Team/Medewerker in de kijker</a>
                <a href="sportief-supportersclubs.html" class="nav-dropdown-link">Supportersclubs</a>
              </div>
            </div>

            <!-- VOETBAL4ALL -->
            <div class="nav-item nav-item--dropdown">
              <button type="button" class="nav-link nav-link--dropdown">
                Voetbal4All <span class="nav-link-caret">â–¾</span>
              </button>
              <div class="nav-dropdown">
                <a href="gebruiksvoorwaarden.html" class="nav-dropdown-link">Gebruiksvoorwaarden</a>
                <a href="privacyverklaring.html" class="nav-dropdown-link">Privacyverklaring</a>
                <a href="contact.html" class="nav-dropdown-link">Contact</a>
              </div>
            </div>
          </nav>

          <a href="adverteren.html" class="nav-cta">
            <span>Adverteer nu</span>
            <span>Sponsor &amp; Ads</span>
          </a>

          <button class="nav-burger" aria-label="Menu">â˜°</button>
        </div>
      </div>
    </header>

    <!-- LIVE BANNER (PC + tablet, mobiel hidden via body class) -->
    <section class="live-banner-top">
      <div class="shell">
        <div class="live-banner">
          <div class="live-label">
            <span class="live-dot"></span>
            Live resultaten
          </div>
          <div class="live-text">
            <span class="live-text-main"></span>
            <div class="live-updated"></div>
          </div>
          <div class="live-socials" aria-label="Volg Voetbal4All op social media">
            <div class="live-socials-label">Volg ons</div>
            <div class="live-socials-icons"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- HEADER AD -->
    <section class="section-main" style="padding-top:10px;padding-bottom:10px;">
      <div class="shell">
        <div class="ad-slot ad-slot-header sticky-ad-header">
          <ins class="adsbygoogle"
            style="display:block"
            data-ad-client="ca-pub-4062633211824348"
            data-ad-slot="3518144343"
            data-ad-format="auto"
            data-full-width-responsive="true"></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </div>
    </section>

    <main>
      <section class="section-main">
        <div class="shell">

          <!-- INTRO -->
          <article class="card" style="margin-bottom:12px;">
            <div class="card-header">
              <div>
                <div class="card-caption">Sportieve events</div>
                <div class="card-title">Vriendschappelijk, tornooi, stage &amp; voetbalkamp</div>
              </div>
              <span class="pill-small">Clubs Â· trainers Â· teams</span>
            </div>
            <p class="note">
              Dit overzicht is uitsluitend voor sportieve events. Voor eetdagen, bingo, darts, quiz of fuif ga je naar <strong>Club &amp; fun</strong>.
            </p>
          </article>

          <!-- CONTENT LINKS + STICKY ADS RECHTS -->
          <div class="v4-layout-sidebar">

            <!-- LINKS -->
            <div class="v4-content">

              <!-- ZOEK- EN FILTERBALK -->
              <div class="search-bar search-bar--advanced" style="margin-bottom:12px;">
                <input
                  type="text"
                  id="event-search-text"
                  class="search-input"
                  placeholder="Zoek op club, eventnaam, regio..."
                />
                <div class="search-filters-row">
                  <select id="event-filter-country" class="search-select">
                    <option value="">Land (alles)</option>
                    <option value="BE">ðŸ‡§ðŸ‡ª BelgiÃ«</option>
                    <option value="NL">ðŸ‡³ðŸ‡± Nederland</option>
                  </select>

                  <select id="event-filter-type" class="search-select">
                    <option value="">Type (alles)</option>
                    <option value="Vriendschappelijk">Vriendschappelijk</option>
                    <option value="Tornooi">Tornooi</option>
                    <option value="Stage">Stage</option>
                    <option value="Voetbalkamp">Voetbalkamp</option>
                  </select>

                  <select id="event-filter-month" class="search-select">
                    <option value="">Maand (alles)</option>
                    <option value="01">Januari</option>
                    <option value="02">Februari</option>
                    <option value="03">Maart</option>
                    <option value="04">April</option>
                    <option value="05">Mei</option>
                    <option value="06">Juni</option>
                    <option value="07">Juli</option>
                    <option value="08">Augustus</option>
                    <option value="09">September</option>
                    <option value="10">Oktober</option>
                    <option value="11">November</option>
                    <option value="12">December</option>
                  </select>
                </div>
                <div class="form-helper">
                  Tip: via de navigatie zet je automatisch een type-filter (bv. Tornooien).
                </div>
              </div>


              <!-- OVERZICHT -->
              <section class="section-main" style="padding-top:0;">
                <div class="card">
                  <div class="card-header">
                    <div>
                      <div class="card-caption">Overzicht</div>
                      <div class="card-title">Sportieve events</div>
                    </div>
                    <span class="pill-small">Onder elkaar</span>
                  </div>

                  <p class="note">
                    Events met een datum in het verleden worden automatisch verborgen (dag na het event).
                  </p>

                  <!-- PREMIUM (komende 30 dagen): 2 rijen x 2 kolommen = 4 kaarten, roterend per kaart -->
                  <div id="premium-30-wrap" class="premium-block" style="display:none;">
                    <div class="card" style="margin-bottom:12px;">
                      <div class="card-header">
                        <div>
                          <div class="card-caption">Premium</div>
                          <div class="card-title">Premium events komende 30 dagen</div>
                        </div>
                        <span class="pill-small">Rotatie</span>
                      </div>
                      <div id="premium-grid-30" class="events-grid-2 premium-grid"></div>
                    </div>
                  </div>

                  <!-- IN-CONTENT AD -->
                  <section class="section-main" style="padding-top:0;padding-bottom:10px;">
                    <div class="ad-infeed">
                      <ins class="adsbygoogle"
                        style="display:block"
                        data-ad-client="ca-pub-4062633211824348"
                        data-ad-slot="4831226012"
                        data-ad-format="auto"
                        data-full-width-responsive="true"></ins>
                      <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                      </script>
                    </div>
                  </section>

                  <!-- Overige events (2 kolommen) -->

                  <div id="event-list" class="events-grid-2">
                    <!-- gevuld via backend -->
                  </div>

                  <div id="events-pagination" class="events-pagination" aria-label="Paginatie events"></div>

                  <p id="event-status" class="note" style="margin-top:10px; display:none;"></p>
                </div>

              </section>

            </div>

            <!-- RECHTS -->
            <aside class="v4-sidebar">
              <div class="v4-sidebar-sticky">

                <article class="card">
                  <div class="card-header">
                    <div>
                      <div class="card-caption">Advertentie</div>
                      <div class="card-title">Sponsor / Partner</div>
                    </div>
                    <span class="pill-small">Premium</span>
                  </div>
                  <div class="ad-placeholder">
                    Ideaal voor event-organisatoren, bekers/trofeeÃ«n, busreizen, stages, sportkleding, â€¦
                    <br/>
                    <span class="ad-size">Aanrader: 300 Ã— 250 of 300 Ã— 600</span>
                  </div>
                </article>

                <!-- Sticky AdSense -->
                <div class="ad-vertical v4-ad-sticky" style="margin-top:12px;">
                  <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-client="ca-pub-4062633211824348"
                    data-ad-slot="6032627042"
                    data-ad-format="auto"
                    data-full-width-responsive="true"></ins>
                  <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                  </script>
                </div>

                <article class="card" style="margin-top:12px;">
                  <div class="card-header">
                    <div>
                      <div class="card-caption">Organiseer je een sportief event?</div>
                      <div class="card-title">Meer teams, meer bereik</div>
                    </div>
                  </div>
                  <p class="note">
                    Plaats je tornooi, stage of vriendschappelijke wedstrijd en bereik clubs en teams in jouw regio Ã©n daarbuiten.
                  </p>
                </article>

                <!-- Premium events > 30 dagen (10 cards, roterend) -->
                <article class="card" style="margin-top:12px;">
                  <div class="card-header">
                    <div>
                      <div class="card-caption">Premium</div>
                      <div class="card-title">Uitgelicht (later)</div>
                    </div>
                    <span class="pill-small">Rotatie</span>
                  </div>
                  <div id="sidebar-premium-later" class="sidebar-premium-stack"></div>
                </article>

              </div>
            </aside>

          </div>

        </div>
      </section>
    </main>

    <!-- FOOTER -->
    <footer class="footer" id="footer-contact">
      <div class="shell">
        <div class="footer-grid">
          <div class="footer-brand">
            <div>Voetbal4All Â· voor spelers, ouders, trainers en clubs.</div>
            <div class="footer-legal">
              &copy; <span id="year"></span> Voetbal4All. Alle rechten voorbehouden.
            </div>
            <div class="footer-social">
              <a href="https://www.facebook.com/voetbal4all" target="_blank" rel="noopener noreferrer" class="footer-social-link">Facebook</a>
              <a href="https://www.instagram.com/voetbal.4.all/" target="_blank" rel="noopener noreferrer" class="footer-social-link">Instagram</a>
              <a href="https://www.tiktok.com/@voetbal4all.eu" target="_blank" rel="noopener noreferrer" class="footer-social-link">TikTok</a>
            </div>
          </div>
          <div class="footer-ad">
            FOOTER ADVERTENTIE / PARTNERLOGO<br>
            <span class="ad-size">Footer-banner</span>
          </div>
        </div>
      </div>
    </footer>

  </div>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    // Auto type filter via ?type=
    (function initTypeFromUrl() {
      const params = new URLSearchParams(window.location.search);
      const t = params.get("type");
      if (!t) return;

      const sel = document.getElementById("event-filter-type");
      if (!sel) return;

      for (const opt of sel.options) {
        if (opt.value === t) { sel.value = t; break; }
      }
    })();

    const listEl = document.getElementById("event-list");
    const searchEl = document.getElementById("event-search-text");
    const countryEl = document.getElementById("event-filter-country");
    const typeEl = document.getElementById("event-filter-type");
    const monthEl = document.getElementById("event-filter-month");

    const API_BASE = "https://voetbal4all-backend-database.onrender.com";

    function typeToUiLabel(eventType){
      const t = String(eventType || "").toLowerCase();
      if (t === "tournament" || t === "tornooi") return "Tornooi";
      if (t === "friendly" || t === "vriendschappelijk") return "Vriendschappelijk";
      if (t === "stage") return "Stage";
      if (t === "camp" || t === "voetbalkamp") return "Voetbalkamp";
      // fallback: keep existing value if it matches one of the UI options
      return eventType || "";
    }

    function countryToLabel(cc){
      const c = String(cc || "").toUpperCase();
      if (c === "BE") return "ðŸ‡§ðŸ‡ª BelgiÃ«";
      if (c === "NL") return "ðŸ‡³ðŸ‡± Nederland";
      return c || "";
    }

    function fmtDayMonth(dateStrOrIso){
      const d = new Date(dateStrOrIso);
      if (isNaN(d.getTime())) return "";
      return d.toLocaleDateString("nl-BE", { day: "numeric", month: "long" });
    }

    function isoDateOnly(dateStrOrIso){
      const d = new Date(dateStrOrIso);
      if (isNaN(d.getTime())) return "";
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, "0");
      const day = String(d.getDate()).padStart(2, "0");
      return `${y}-${m}-${day}`;
    }

    // --- Share SVG icons (match premium-success style) ---
    const ICON_FB = `<svg viewBox="0 0 24 24" aria-hidden="true"><path class="fill" d="M14 8.5V7c0-.8.3-1.2 1.2-1.2H17V3h-2.4C12 3 11 4.5 11 6.8V8.5H9v3h2V21h3v-9.5h2.4l.6-3H14z"/></svg>`;
    const ICON_IG = `<svg viewBox="0 0 24 24" aria-hidden="true"><rect x="7" y="7" width="10" height="10" rx="3"/><circle cx="12" cy="12" r="2.5"/><circle cx="15.5" cy="8.5" r=".5" class="fill"/></svg>`;
    const ICON_TT = `<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M14 4v10.2a3.8 3.8 0 1 1-3-3.7"/><path d="M14 4c.4 2.6 2.1 4.4 4.8 4.8"/></svg>`;
    const ICON_X  = `<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 4l16 16"/><path d="M20 4L4 20"/></svg>`;
    const ICON_COPY = `<svg viewBox="0 0 24 24" aria-hidden="true"><rect x="9" y="9" width="10" height="10" rx="2"/><path d="M7 15H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v1"/></svg>`;

    function shareButtonsHtml(slug, title, small=false){
      const cls = small ? 'is-small' : '';
      const safeTitle = String(title || '').replaceAll('"','&quot;');
      return `
        <div class="share-live" aria-label="Deel dit event">
          <a class="share-a ${cls}" href="#" data-share-channel="fb" data-share-slug="${String(slug)}" data-share-title="${safeTitle}" target="_blank" rel="noopener noreferrer" aria-label="Deel op Facebook">${ICON_FB}</a>
          <a class="share-a ${cls}" href="#" data-share-channel="ig" data-share-slug="${String(slug)}" data-share-title="${safeTitle}" aria-label="Deel op Instagram">${ICON_IG}</a>
          <a class="share-a ${cls}" href="#" data-share-channel="tt" data-share-slug="${String(slug)}" data-share-title="${safeTitle}" aria-label="Deel op TikTok">${ICON_TT}</a>
          <a class="share-a ${cls}" href="#" data-share-channel="x"  data-share-slug="${String(slug)}" data-share-title="${safeTitle}" target="_blank" rel="noopener noreferrer" aria-label="Deel op X">${ICON_X}</a>
          <a class="share-a ${cls}" href="#" data-share-channel="copy" data-share-slug="${String(slug)}" data-share-title="${safeTitle}" aria-label="Kopieer link">${ICON_COPY}</a>
        </div>
      `;
    }

    function getThumb(ev){
      return (ev.cover_image_url || ev.flyer_image_url || (Array.isArray(ev.photo_urls) ? ev.photo_urls[0] : null) || (typeof ev.photo_urls === "string" ? ev.photo_urls.split(",")[0]?.trim() : null) || "");
    }

    function safeAttr(s){
      return String(s || '').replaceAll('"','&quot;');
    }

    // Pagination and global event lists
    const PAGE_SIZE = 20;
    let ALL_EVENTS_SORTED = [];
    let PINNED_PREMIUM_30 = [];
    let CURRENT_PAGE = 1;

    async function loadEvents(){
      try {
        const res = await fetch(`${API_BASE}/api/events?limit=200&nocache=1`);
        const data = await res.json();

        if (!data || !data.ok || !Array.isArray(data.items)) {
          throw new Error("Bad response");
        }

        // Sort by start date (soonest first)
        const itemsSorted = [...data.items].sort((a,b) => new Date(a.start_at).getTime() - new Date(b.start_at).getTime());

        ALL_EVENTS_SORTED = itemsSorted;

        // Premium buckets
        const now = new Date();
        const in30 = new Date(now.getTime() + 30*24*60*60*1000);
        const premiumAll = itemsSorted.filter(ev => !!ev.is_premium);
        const premium30 = premiumAll.filter(ev => {
          const d = new Date(ev.start_at);
          return !isNaN(d.getTime()) && d >= now && d <= in30;
        });
        const premiumLater = premiumAll.filter(ev => {
          const d = new Date(ev.start_at);
          return !isNaN(d.getTime()) && d > in30;
        });

        // Pinned premium (<=30 days) always shown at top
        PINNED_PREMIUM_30 = premium30;

        // Other list below (everything except the pinned premium <=30d)
        const otherEvents = itemsSorted.filter(ev => {
          if (!ev.is_premium) return true;
          const d = new Date(ev.start_at);
          return !(!!ev.is_premium && !isNaN(d.getTime()) && d >= now && d <= in30);
        });

        function adSlimHtml(){
          return `
            <div class="ad-infeed" style="grid-column:1 / -1;">
              <ins class="adsbygoogle"
                style="display:block"
                data-ad-client="ca-pub-4062633211824348"
                data-ad-slot="4831226012"
                data-ad-format="auto"
                data-full-width-responsive="true"></ins>
            </div>
          `;
        }

        function cardHtml(ev){
          const slug = ev.slug || ev.id;
          const country = String(ev.country || "").toUpperCase();
          const uiType = typeToUiLabel(ev.event_type);
          const dateOnly = isoDateOnly(ev.start_at);
          const rightMeta = (uiType ? uiType + " Â· " : "") + fmtDayMonth(ev.start_at);

          const leftMetaParts = [
            countryToLabel(country),
            ev.city ? ev.city : null,
          ].filter(Boolean);
          const leftMeta = leftMetaParts.join(" Â· ");

          const bodyParts = [];
          if (ev.location_name) bodyParts.push(`<strong>Locatie:</strong> ${ev.location_name}`);
          if (ev.address) bodyParts.push(ev.address);
          const bodyTop = bodyParts.length ? (bodyParts.join(" Â· ") + "<br/>") : "";

          const desc = ev.description ? String(ev.description) : "";
          const thumb = getThumb(ev);
          const safeThumb = safeAttr(thumb);

          return `
            <article class="ad-card" id="event-ad-${encodeURIComponent(slug)}"
              data-ad-id="${String(slug)}"
              data-title="${String(ev.title || "").replaceAll('"','&quot;')}"
              data-country="${country}"
              data-type="${uiType}"
              data-date="${dateOnly}"
              data-slug="${String(slug)}">

              <div class="event-row">
                <div class="event-thumbbox ${safeThumb ? 'has-img' : ''}" aria-label="Flyer thumbnail">
                  ${safeThumb ? `<div class="thumbbg" style="background-image:url('${safeThumb}')"></div>` : ``}
                </div>

                <div class="event-main">
                  <div class="ad-card-header" style="margin:0;">
                    <div>
                      <div class="ad-card-title">${ev.title || ""}</div>
                      <div class="ad-card-meta">${leftMeta}</div>
                    </div>
                    <div class="ad-card-meta">${rightMeta}</div>
                  </div>

                  <div class="ad-card-body" style="margin-top:8px;">
                    ${bodyTop}
                    ${desc}
                  </div>

                  <div class="ad-card-actions event-actions" style="margin-top:10px;">
                    <a class="btn-ghost-sm" href="event.html?slug=${encodeURIComponent(slug)}">Bekijk event</a>
                    <button type="button" class="btn-ghost-sm" data-reply-event="${String(slug)}">Inschrijven / contact</button>
                    ${shareButtonsHtml(slug, ev.title || '', false)}
                  </div>
                </div>
              </div>

            </article>
          `;
        }

        function renderPagination(totalPages){
          const pagEl = document.getElementById('events-pagination');
          if (!pagEl) return;
          if (totalPages <= 1){ pagEl.innerHTML = ''; return; }

          const btn = (label, page, disabled=false, active=false) =>
            `<button type="button" class="page-btn ${active ? 'is-active' : ''}" data-page="${page}" ${disabled ? 'disabled' : ''}>${label}</button>`;

          const pages = [];
          // compact paging: show first, last, current Â±2
          const set = new Set([1, totalPages, CURRENT_PAGE-2, CURRENT_PAGE-1, CURRENT_PAGE, CURRENT_PAGE+1, CURRENT_PAGE+2]);
          const nums = Array.from(set).filter(n => n>=1 && n<=totalPages).sort((a,b)=>a-b);

          let html = '';
          html += btn('Vorige', Math.max(1, CURRENT_PAGE-1), CURRENT_PAGE===1);
          let last = 0;
          for (const n of nums){
            if (last && n > last + 1) html += `<span style="opacity:.55;padding:0 4px;">â€¦</span>`;
            html += btn(String(n), n, false, n===CURRENT_PAGE);
            last = n;
          }
          html += btn('Volgende', Math.min(totalPages, CURRENT_PAGE+1), CURRENT_PAGE===totalPages);

          pagEl.innerHTML = html;
        }

        function renderPage(page){
          // Always render pinned premium grid (top)
          startPremium30Grid(PINNED_PREMIUM_30);

          const total = otherEvents.length;
          const totalPages = Math.max(1, Math.ceil(total / PAGE_SIZE));
          CURRENT_PAGE = Math.min(Math.max(1, page), totalPages);

          const start = (CURRENT_PAGE - 1) * PAGE_SIZE;
          const slice = otherEvents.slice(start, start + PAGE_SIZE);

          // Build 2-col grid items, with a slim AdSense after 10 rows
          const parts = [];
          slice.forEach((ev, idx) => {
            parts.push(cardHtml(ev));
            if (idx === 9) parts.push(adSlimHtml());
          });

          listEl.innerHTML = parts.join('');

          // Trigger AdSense for any inserted ins
          try { (adsbygoogle = window.adsbygoogle || []).push({}); } catch(_) {}

          // Apply existing behaviors after render
          hidePastEvents();
          filterCards();
          updateShareLinks();
          renderPagination(totalPages);
        }

        // initial page render
        renderPage(1);

        // pagination click
        document.getElementById('events-pagination')?.addEventListener('click', (e) => {
          const b = e.target.closest('button[data-page]');
          if (!b) return;
          const p = Number(b.getAttribute('data-page') || '1');
          if (!Number.isFinite(p)) return;
          renderPage(p);
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Sidebar premium later rotator stays
        startSidebarPremiumLater(premiumLater);

      } catch (e) {
        console.error("[EVENTS] load failed", e);
        const status = document.getElementById("event-status");
        if (status) {
          status.style.display = "block";
          status.textContent = "Events konden niet geladen worden.";
        }
      }
    }
    function startPremium30Grid(premium30){
      const wrap = document.getElementById('premium-30-wrap');
      const grid = document.getElementById('premium-grid-30');
      if (!wrap || !grid) return;

      if (!premium30 || premium30.length === 0) {
        wrap.style.display = 'none';
        return;
      }
      wrap.style.display = 'block';

      // 4 visible cards (2x2). Each slot advances with its own offset so the order differs.
      const slots = 4;
      const offsets = [0, 2, 5, 7];
      let tick = 0;

      function render(){
        grid.innerHTML = '';
        for (let s=0; s<slots; s++){
          const ev = premium30[(tick + offsets[s]) % premium30.length];
          const slug = ev.slug || ev.id;
          const country = String(ev.country || '').toUpperCase();
          const uiType = typeToUiLabel(ev.event_type);
          const rightMeta = (uiType ? uiType + ' Â· ' : '') + fmtDayMonth(ev.start_at);
          const leftMeta = [countryToLabel(country), ev.city ? ev.city : null].filter(Boolean).join(' Â· ');
          const thumb = getThumb(ev);
          const safeThumb = safeAttr(thumb);

          const bodyTop = [];
          if (ev.location_name) bodyTop.push(`<strong>Locatie:</strong> ${ev.location_name}`);
          if (ev.address) bodyTop.push(ev.address);
          const top = bodyTop.length ? (bodyTop.join(' Â· ') + '<br/>') : '';
          const desc = ev.description ? String(ev.description) : '';

          grid.insertAdjacentHTML('beforeend', `
            <article class="ad-card" id="premium30-${encodeURIComponent(String(slug))}" data-slug="${String(slug)}">
              <div class="event-row">
                <div class="event-thumbbox ${safeThumb ? 'has-img' : ''}" aria-label="Flyer thumbnail">
                  ${safeThumb ? `<div class="thumbbg" style="background-image:url('${safeThumb}')"></div>` : ``}
                </div>
                <div class="event-main">
                  <div class="ad-card-header" style="margin:0;">
                    <div>
                      <div class="ad-card-title">${ev.title || ''}</div>
                      <div class="ad-card-meta">${leftMeta}</div>
                    </div>
                    <div class="ad-card-meta">Premium Â· ${rightMeta}</div>
                  </div>
                  <div class="ad-card-body" style="margin-top:8px;">${top}${desc}</div>
                  <div class="ad-card-actions event-actions" style="margin-top:10px;">
                    <a class="btn-ghost-sm" href="event.html?slug=${encodeURIComponent(slug)}">Bekijk event</a>
                    ${shareButtonsHtml(slug, ev.title || '', false)}
                  </div>
                </div>
              </div>
            </article>
          `);
        }
        updateShareLinks();
      }

      render();
      setInterval(() => {
        tick = (tick + 1) % premium30.length;
        render();
      }, 10000);
    }

    function startSidebarPremiumLater(premiumLater){
      const el = document.getElementById('sidebar-premium-later');
      if (!el) return;

      if (!premiumLater || premiumLater.length === 0){
        el.innerHTML = '<p class="note" style="margin:0;">Geen premium events later dan 30 dagen.</p>';
        return;
      }

      const slots = 10;
      let tick = 0;

      function render(){
        el.innerHTML = '';
        for (let s=0; s<slots; s++){
          const ev = premiumLater[(tick + s) % premiumLater.length];
          const slug = ev.slug || ev.id;
          const country = String(ev.country || '').toUpperCase();
          const uiType = typeToUiLabel(ev.event_type);
          const meta = [(uiType ? uiType : null), fmtDayMonth(ev.start_at), countryToLabel(country), ev.city ? ev.city : null].filter(Boolean).join(' Â· ');
          const thumb = getThumb(ev);
          const safeThumb = safeAttr(thumb);

          el.insertAdjacentHTML('beforeend', `
            <div class="sidebar-premium-card" data-slug="${String(slug)}">
              <div class="sidebar-premium-top">
                <div class="sidebar-premium-thumbbox" aria-label="Flyer thumbnail">
                  ${safeThumb ? `<div class="thumbbg" style="background-image:url('${safeThumb}')"></div>` : ``}
                </div>
                <div style="min-width:0;">
                  <div class="sidebar-premium-title">${ev.title || ''}</div>
                  <div class="sidebar-premium-meta">${meta}</div>
                </div>
              </div>
              <div class="sidebar-premium-actions">
                <a class="btn-ghost-sm" href="event.html?slug=${encodeURIComponent(slug)}">Bekijk</a>
                ${shareButtonsHtml(slug, ev.title || '', true)}
              </div>
            </div>
          `);
        }
        updateShareLinks();
      }

      render();
      setInterval(() => { tick = (tick + 1) % premiumLater.length; render(); }, 10000);
    }

    function norm(s){ return (s || "").toLowerCase(); }

    // Verberg events waarvan datum + 1 dag < vandaag
    function hidePastEvents() {
      const cards = document.querySelectorAll("#event-list .ad-card[data-date]");
      const today = new Date();
      today.setHours(0,0,0,0);

      cards.forEach(card => {
        const dateStr = card.getAttribute("data-date");
        if (!dateStr) return;
        const d = new Date(dateStr);
        if (isNaN(d.getTime())) return;

        d.setDate(d.getDate() + 1);
        d.setHours(0,0,0,0);

        if (d < today) card.style.display = "none";
      });
    }

    function filterCards(){
      const q = norm(searchEl.value);
      const c = countryEl.value;
      const t = typeEl.value;
      const m = monthEl.value;

      const cards = listEl.querySelectorAll(".ad-card");
      cards.forEach(card => {
        const cc = card.dataset.country || "";
        const tt = card.dataset.type || "";
        const dd = card.dataset.date || ""; // YYYY-MM-DD
        const hay = norm(card.textContent);

        let ok = true;
        if (c && cc && cc !== c) ok = false;
        if (t && tt && tt !== t) ok = false;
        if (m && dd && dd.slice(5,7) !== m) ok = false;
        if (ok && q && !hay.includes(q)) ok = false;

        card.style.display = ok ? "" : "none";
      });
    }

    searchEl.addEventListener("input", filterCards);
    countryEl.addEventListener("change", filterCards);
    typeEl.addEventListener("change", filterCards);
    monthEl.addEventListener("change", filterCards);

    function updateShareLinks(){
      document.querySelectorAll('[data-share-channel][data-share-slug]').forEach(a => {
        a.onclick = null;
        const slug = a.getAttribute('data-share-slug') || '';
        const title = (a.getAttribute('data-share-title') || 'Event') + ' â€“ Voetbal4All';
        const shareUrl = 'https://www.voetbal4all.eu/event.html?slug=' + encodeURIComponent(slug);

        const ch = a.getAttribute('data-share-channel');
        const encUrl = encodeURIComponent(shareUrl);
        const encText = encodeURIComponent(title);

        if (ch === 'fb') {
          a.href = 'https://www.facebook.com/sharer/sharer.php?u=' + encUrl;
          a.target = '_blank';
        }
        else if (ch === 'x') {
          a.href = 'https://twitter.com/intent/tweet?text=' + encText + '&url=' + encUrl;
          a.target = '_blank';
        }
        else if (ch === 'ig' || ch === 'tt') {
          // Instagram/TikTok: no reliable web share URL; use Web Share on supported devices, else copy.
          a.href = '#';
          a.onclick = async (ev) => {
            ev.preventDefault();
            const payload = { title, text: title, url: shareUrl };
            try {
              if (navigator.share) {
                await navigator.share(payload);
                return;
              }
            } catch (_) {}
            try {
              await navigator.clipboard.writeText(shareUrl);
              alert('Link gekopieerd. Plak hem nu in je ' + (ch === 'ig' ? 'Instagram' : 'TikTok') + ' post: ' + shareUrl);
            } catch(e){
              prompt('Kopieer deze link en plak hem in je ' + (ch === 'ig' ? 'Instagram' : 'TikTok') + ' post:', shareUrl);
            }
          };
        }
        else if (ch === 'copy') {
          a.href = '#';
          a.onclick = async (ev) => {
            ev.preventDefault();
            try { await navigator.clipboard.writeText(shareUrl); alert('Link gekopieerd: ' + shareUrl); }
            catch(e){ prompt('Kopieer deze link:', shareUrl); }
          };
        }
      });
    }

    // Reply flow via mailto (zelfde patroon)
    document.addEventListener("click", function(e){
      const btn = e.target.closest("[data-reply-event]");
      if (!btn) return;

      const id = btn.getAttribute("data-reply-event");
      const card = btn.closest(".ad-card");
      const title = card?.querySelector(".ad-card-title")?.textContent?.trim() || card?.dataset?.title || "Sportief event";
      const ok = confirm("Door verder te gaan, ga je akkoord dat jouw e-mailadres gebruikt wordt om te reageren via Voetbal4All.");
      if (!ok) return;

      const email = prompt("Vul je e-mailadres in zodat de club je kan contacteren:");
      if (!email) return alert("E-mailadres is nodig om te kunnen reageren.");

      const subject = encodeURIComponent("Reactie via Voetbal4All â€“ " + title);
      const body = encodeURIComponent(
        "Event: " + title +
        "\nSlug/ID: " + id +
        "\n\nE-mailadres: " + email +
        "\n\nBericht:\n(Voeg je bericht toe.)"
      );

      location.href = "mailto:voetbal4all@outlook.com?subject=" + subject + "&body=" + body;
    });

    // Load events from backend
    loadEvents();
  </script>

  <script src="assets/js/nav-mobile.js"></script>
  <script src="assets/js/live-banner.js"></script>
</body>
</html>